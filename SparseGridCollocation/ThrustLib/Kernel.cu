#include "Gaussian2d.h"
#include "Common.h"

using Eigen::MatrixXd;
using Eigen::VectorXd;
using namespace std;
using namespace Eigen;
using namespace thrust; 
using namespace Leicester::ThrustLib;


MatrixXd GetTX7()
{
	MatrixXd TX1(195, 2);
	TX1(0, 0) = 0;
	TX1(1, 0) = 0;
	TX1(2, 0) = 0;
	TX1(3, 0) = 0;
	TX1(4, 0) = 0;
	TX1(5, 0) = 0;
	TX1(6, 0) = 0;
	TX1(7, 0) = 0;
	TX1(8, 0) = 0;
	TX1(9, 0) = 0;
	TX1(10, 0) = 0;
	TX1(11, 0) = 0;
	TX1(12, 0) = 0;
	TX1(13, 0) = 0;
	TX1(14, 0) = 0;
	TX1(15, 0) = 0;
	TX1(16, 0) = 0;
	TX1(17, 0) = 0;
	TX1(18, 0) = 0;
	TX1(19, 0) = 0;
	TX1(20, 0) = 0;
	TX1(21, 0) = 0;
	TX1(22, 0) = 0;
	TX1(23, 0) = 0;
	TX1(24, 0) = 0;
	TX1(25, 0) = 0;
	TX1(26, 0) = 0;
	TX1(27, 0) = 0;
	TX1(28, 0) = 0;
	TX1(29, 0) = 0;
	TX1(30, 0) = 0;
	TX1(31, 0) = 0;
	TX1(32, 0) = 0;
	TX1(33, 0) = 0;
	TX1(34, 0) = 0;
	TX1(35, 0) = 0;
	TX1(36, 0) = 0;
	TX1(37, 0) = 0;
	TX1(38, 0) = 0;
	TX1(39, 0) = 0;
	TX1(40, 0) = 0;
	TX1(41, 0) = 0;
	TX1(42, 0) = 0;
	TX1(43, 0) = 0;
	TX1(44, 0) = 0;
	TX1(45, 0) = 0;
	TX1(46, 0) = 0;
	TX1(47, 0) = 0;
	TX1(48, 0) = 0;
	TX1(49, 0) = 0;
	TX1(50, 0) = 0;
	TX1(51, 0) = 0;
	TX1(52, 0) = 0;
	TX1(53, 0) = 0;
	TX1(54, 0) = 0;
	TX1(55, 0) = 0;
	TX1(56, 0) = 0;
	TX1(57, 0) = 0;
	TX1(58, 0) = 0;
	TX1(59, 0) = 0;
	TX1(60, 0) = 0;
	TX1(61, 0) = 0;
	TX1(62, 0) = 0;
	TX1(63, 0) = 0;
	TX1(64, 0) = 0;
	TX1(65, 0) = 0.432499999999999;
	TX1(66, 0) = 0.432499999999999;
	TX1(67, 0) = 0.432499999999999;
	TX1(68, 0) = 0.432499999999999;
	TX1(69, 0) = 0.432499999999999;
	TX1(70, 0) = 0.432499999999999;
	TX1(71, 0) = 0.432499999999999;
	TX1(72, 0) = 0.432499999999999;
	TX1(73, 0) = 0.432499999999999;
	TX1(74, 0) = 0.432499999999999;
	TX1(75, 0) = 0.432499999999999;
	TX1(76, 0) = 0.432499999999999;
	TX1(77, 0) = 0.432499999999999;
	TX1(78, 0) = 0.432499999999999;
	TX1(79, 0) = 0.432499999999999;
	TX1(80, 0) = 0.432499999999999;
	TX1(81, 0) = 0.432499999999999;
	TX1(82, 0) = 0.432499999999999;
	TX1(83, 0) = 0.432499999999999;
	TX1(84, 0) = 0.432499999999999;
	TX1(85, 0) = 0.432499999999999;
	TX1(86, 0) = 0.432499999999999;
	TX1(87, 0) = 0.432499999999999;
	TX1(88, 0) = 0.432499999999999;
	TX1(89, 0) = 0.432499999999999;
	TX1(90, 0) = 0.432499999999999;
	TX1(91, 0) = 0.432499999999999;
	TX1(92, 0) = 0.432499999999999;
	TX1(93, 0) = 0.432499999999999;
	TX1(94, 0) = 0.432499999999999;
	TX1(95, 0) = 0.432499999999999;
	TX1(96, 0) = 0.432499999999999;
	TX1(97, 0) = 0.432499999999999;
	TX1(98, 0) = 0.432499999999999;
	TX1(99, 0) = 0.432499999999999;
	TX1(100, 0) = 0.432499999999999;
	TX1(101, 0) = 0.432499999999999;
	TX1(102, 0) = 0.432499999999999;
	TX1(103, 0) = 0.432499999999999;
	TX1(104, 0) = 0.432499999999999;
	TX1(105, 0) = 0.432499999999999;
	TX1(106, 0) = 0.432499999999999;
	TX1(107, 0) = 0.432499999999999;
	TX1(108, 0) = 0.432499999999999;
	TX1(109, 0) = 0.432499999999999;
	TX1(110, 0) = 0.432499999999999;
	TX1(111, 0) = 0.432499999999999;
	TX1(112, 0) = 0.432499999999999;
	TX1(113, 0) = 0.432499999999999;
	TX1(114, 0) = 0.432499999999999;
	TX1(115, 0) = 0.432499999999999;
	TX1(116, 0) = 0.432499999999999;
	TX1(117, 0) = 0.432499999999999;
	TX1(118, 0) = 0.432499999999999;
	TX1(119, 0) = 0.432499999999999;
	TX1(120, 0) = 0.432499999999999;
	TX1(121, 0) = 0.432499999999999;
	TX1(122, 0) = 0.432499999999999;
	TX1(123, 0) = 0.432499999999999;
	TX1(124, 0) = 0.432499999999999;
	TX1(125, 0) = 0.432499999999999;
	TX1(126, 0) = 0.432499999999999;
	TX1(127, 0) = 0.432499999999999;
	TX1(128, 0) = 0.432499999999999;
	TX1(129, 0) = 0.432499999999999;
	TX1(130, 0) = 0.864999999999999;
	TX1(131, 0) = 0.864999999999999;
	TX1(132, 0) = 0.864999999999999;
	TX1(133, 0) = 0.864999999999999;
	TX1(134, 0) = 0.864999999999999;
	TX1(135, 0) = 0.864999999999999;
	TX1(136, 0) = 0.864999999999999;
	TX1(137, 0) = 0.864999999999999;
	TX1(138, 0) = 0.864999999999999;
	TX1(139, 0) = 0.864999999999999;
	TX1(140, 0) = 0.864999999999999;
	TX1(141, 0) = 0.864999999999999;
	TX1(142, 0) = 0.864999999999999;
	TX1(143, 0) = 0.864999999999999;
	TX1(144, 0) = 0.864999999999999;
	TX1(145, 0) = 0.864999999999999;
	TX1(146, 0) = 0.864999999999999;
	TX1(147, 0) = 0.864999999999999;
	TX1(148, 0) = 0.864999999999999;
	TX1(149, 0) = 0.864999999999999;
	TX1(150, 0) = 0.864999999999999;
	TX1(151, 0) = 0.864999999999999;
	TX1(152, 0) = 0.864999999999999;
	TX1(153, 0) = 0.864999999999999;
	TX1(154, 0) = 0.864999999999999;
	TX1(155, 0) = 0.864999999999999;
	TX1(156, 0) = 0.864999999999999;
	TX1(157, 0) = 0.864999999999999;
	TX1(158, 0) = 0.864999999999999;
	TX1(159, 0) = 0.864999999999999;
	TX1(160, 0) = 0.864999999999999;
	TX1(161, 0) = 0.864999999999999;
	TX1(162, 0) = 0.864999999999999;
	TX1(163, 0) = 0.864999999999999;
	TX1(164, 0) = 0.864999999999999;
	TX1(165, 0) = 0.864999999999999;
	TX1(166, 0) = 0.864999999999999;
	TX1(167, 0) = 0.864999999999999;
	TX1(168, 0) = 0.864999999999999;
	TX1(169, 0) = 0.864999999999999;
	TX1(170, 0) = 0.864999999999999;
	TX1(171, 0) = 0.864999999999999;
	TX1(172, 0) = 0.864999999999999;
	TX1(173, 0) = 0.864999999999999;
	TX1(174, 0) = 0.864999999999999;
	TX1(175, 0) = 0.864999999999999;
	TX1(176, 0) = 0.864999999999999;
	TX1(177, 0) = 0.864999999999999;
	TX1(178, 0) = 0.864999999999999;
	TX1(179, 0) = 0.864999999999999;
	TX1(180, 0) = 0.864999999999999;
	TX1(181, 0) = 0.864999999999999;
	TX1(182, 0) = 0.864999999999999;
	TX1(183, 0) = 0.864999999999999;
	TX1(184, 0) = 0.864999999999999;
	TX1(185, 0) = 0.864999999999999;
	TX1(186, 0) = 0.864999999999999;
	TX1(187, 0) = 0.864999999999999;
	TX1(188, 0) = 0.864999999999999;
	TX1(189, 0) = 0.864999999999999;
	TX1(190, 0) = 0.864999999999999;
	TX1(191, 0) = 0.864999999999999;
	TX1(192, 0) = 0.864999999999999;
	TX1(193, 0) = 0.864999999999999;
	TX1(194, 0) = 0.864999999999999;
	TX1(0, 1) = 0;
	TX1(1, 1) = 4.6875;
	TX1(2, 1) = 9.375;
	TX1(3, 1) = 14.0625;
	TX1(4, 1) = 18.75;
	TX1(5, 1) = 23.4375;
	TX1(6, 1) = 28.125;
	TX1(7, 1) = 32.8125;
	TX1(8, 1) = 37.5;
	TX1(9, 1) = 42.1875;
	TX1(10, 1) = 46.875;
	TX1(11, 1) = 51.5625;
	TX1(12, 1) = 56.25;
	TX1(13, 1) = 60.9375;
	TX1(14, 1) = 65.625;
	TX1(15, 1) = 70.3125;
	TX1(16, 1) = 75;
	TX1(17, 1) = 79.6875;
	TX1(18, 1) = 84.375;
	TX1(19, 1) = 89.0625;
	TX1(20, 1) = 93.75;
	TX1(21, 1) = 98.4375;
	TX1(22, 1) = 103.125;
	TX1(23, 1) = 107.8125;
	TX1(24, 1) = 112.5;
	TX1(25, 1) = 117.1875;
	TX1(26, 1) = 121.875;
	TX1(27, 1) = 126.5625;
	TX1(28, 1) = 131.25;
	TX1(29, 1) = 135.9375;
	TX1(30, 1) = 140.625;
	TX1(31, 1) = 145.3125;
	TX1(32, 1) = 150;
	TX1(33, 1) = 154.6875;
	TX1(34, 1) = 159.375;
	TX1(35, 1) = 164.0625;
	TX1(36, 1) = 168.75;
	TX1(37, 1) = 173.4375;
	TX1(38, 1) = 178.125;
	TX1(39, 1) = 182.8125;
	TX1(40, 1) = 187.5;
	TX1(41, 1) = 192.1875;
	TX1(42, 1) = 196.875;
	TX1(43, 1) = 201.5625;
	TX1(44, 1) = 206.25;
	TX1(45, 1) = 210.9375;
	TX1(46, 1) = 215.625;
	TX1(47, 1) = 220.3125;
	TX1(48, 1) = 225;
	TX1(49, 1) = 229.6875;
	TX1(50, 1) = 234.375;
	TX1(51, 1) = 239.0625;
	TX1(52, 1) = 243.75;
	TX1(53, 1) = 248.4375;
	TX1(54, 1) = 253.125;
	TX1(55, 1) = 257.8125;
	TX1(56, 1) = 262.5;
	TX1(57, 1) = 267.1875;
	TX1(58, 1) = 271.875;
	TX1(59, 1) = 276.5625;
	TX1(60, 1) = 281.25;
	TX1(61, 1) = 285.9375;
	TX1(62, 1) = 290.625;
	TX1(63, 1) = 295.3125;
	TX1(64, 1) = 300;
	TX1(65, 1) = 0;
	TX1(66, 1) = 4.6875;
	TX1(67, 1) = 9.375;
	TX1(68, 1) = 14.0625;
	TX1(69, 1) = 18.75;
	TX1(70, 1) = 23.4375;
	TX1(71, 1) = 28.125;
	TX1(72, 1) = 32.8125;
	TX1(73, 1) = 37.5;
	TX1(74, 1) = 42.1875;
	TX1(75, 1) = 46.875;
	TX1(76, 1) = 51.5625;
	TX1(77, 1) = 56.25;
	TX1(78, 1) = 60.9375;
	TX1(79, 1) = 65.625;
	TX1(80, 1) = 70.3125;
	TX1(81, 1) = 75;
	TX1(82, 1) = 79.6875;
	TX1(83, 1) = 84.375;
	TX1(84, 1) = 89.0625;
	TX1(85, 1) = 93.75;
	TX1(86, 1) = 98.4375;
	TX1(87, 1) = 103.125;
	TX1(88, 1) = 107.8125;
	TX1(89, 1) = 112.5;
	TX1(90, 1) = 117.1875;
	TX1(91, 1) = 121.875;
	TX1(92, 1) = 126.5625;
	TX1(93, 1) = 131.25;
	TX1(94, 1) = 135.9375;
	TX1(95, 1) = 140.625;
	TX1(96, 1) = 145.3125;
	TX1(97, 1) = 150;
	TX1(98, 1) = 154.6875;
	TX1(99, 1) = 159.375;
	TX1(100, 1) = 164.0625;
	TX1(101, 1) = 168.75;
	TX1(102, 1) = 173.4375;
	TX1(103, 1) = 178.125;
	TX1(104, 1) = 182.8125;
	TX1(105, 1) = 187.5;
	TX1(106, 1) = 192.1875;
	TX1(107, 1) = 196.875;
	TX1(108, 1) = 201.5625;
	TX1(109, 1) = 206.25;
	TX1(110, 1) = 210.9375;
	TX1(111, 1) = 215.625;
	TX1(112, 1) = 220.3125;
	TX1(113, 1) = 225;
	TX1(114, 1) = 229.6875;
	TX1(115, 1) = 234.375;
	TX1(116, 1) = 239.0625;
	TX1(117, 1) = 243.75;
	TX1(118, 1) = 248.4375;
	TX1(119, 1) = 253.125;
	TX1(120, 1) = 257.8125;
	TX1(121, 1) = 262.5;
	TX1(122, 1) = 267.1875;
	TX1(123, 1) = 271.875;
	TX1(124, 1) = 276.5625;
	TX1(125, 1) = 281.25;
	TX1(126, 1) = 285.9375;
	TX1(127, 1) = 290.625;
	TX1(128, 1) = 295.3125;
	TX1(129, 1) = 300;
	TX1(130, 1) = 0;
	TX1(131, 1) = 4.6875;
	TX1(132, 1) = 9.375;
	TX1(133, 1) = 14.0625;
	TX1(134, 1) = 18.75;
	TX1(135, 1) = 23.4375;
	TX1(136, 1) = 28.125;
	TX1(137, 1) = 32.8125;
	TX1(138, 1) = 37.5;
	TX1(139, 1) = 42.1875;
	TX1(140, 1) = 46.875;
	TX1(141, 1) = 51.5625;
	TX1(142, 1) = 56.25;
	TX1(143, 1) = 60.9375;
	TX1(144, 1) = 65.625;
	TX1(145, 1) = 70.3125;
	TX1(146, 1) = 75;
	TX1(147, 1) = 79.6875;
	TX1(148, 1) = 84.375;
	TX1(149, 1) = 89.0625;
	TX1(150, 1) = 93.75;
	TX1(151, 1) = 98.4375;
	TX1(152, 1) = 103.125;
	TX1(153, 1) = 107.8125;
	TX1(154, 1) = 112.5;
	TX1(155, 1) = 117.1875;
	TX1(156, 1) = 121.875;
	TX1(157, 1) = 126.5625;
	TX1(158, 1) = 131.25;
	TX1(159, 1) = 135.9375;
	TX1(160, 1) = 140.625;
	TX1(161, 1) = 145.3125;
	TX1(162, 1) = 150;
	TX1(163, 1) = 154.6875;
	TX1(164, 1) = 159.375;
	TX1(165, 1) = 164.0625;
	TX1(166, 1) = 168.75;
	TX1(167, 1) = 173.4375;
	TX1(168, 1) = 178.125;
	TX1(169, 1) = 182.8125;
	TX1(170, 1) = 187.5;
	TX1(171, 1) = 192.1875;
	TX1(172, 1) = 196.875;
	TX1(173, 1) = 201.5625;
	TX1(174, 1) = 206.25;
	TX1(175, 1) = 210.9375;
	TX1(176, 1) = 215.625;
	TX1(177, 1) = 220.3125;
	TX1(178, 1) = 225;
	TX1(179, 1) = 229.6875;
	TX1(180, 1) = 234.375;
	TX1(181, 1) = 239.0625;
	TX1(182, 1) = 243.75;
	TX1(183, 1) = 248.4375;
	TX1(184, 1) = 253.125;
	TX1(185, 1) = 257.8125;
	TX1(186, 1) = 262.5;
	TX1(187, 1) = 267.1875;
	TX1(188, 1) = 271.875;
	TX1(189, 1) = 276.5625;
	TX1(190, 1) = 281.25;
	TX1(191, 1) = 285.9375;
	TX1(192, 1) = 290.625;
	TX1(193, 1) = 295.3125;
	TX1(194, 1) = 300;

	return TX1;
}

MatrixXd GetTX2()
{
	MatrixXd TX1(15, 2);

	TX1(0, 0) = 0;
	TX1(1, 0) = 0;
	TX1(2, 0) = 0;
	TX1(3, 0) = 0;
	TX1(4, 0) = 0;
	TX1(5, 0) = 0.432499999999999;
	TX1(6, 0) = 0.432499999999999;
	TX1(7, 0) = 0.432499999999999;
	TX1(8, 0) = 0.432499999999999;
	TX1(9, 0) = 0.432499999999999;
	TX1(10, 0) = 0.864999999999999;
	TX1(11, 0) = 0.864999999999999;
	TX1(12, 0) = 0.864999999999999;
	TX1(13, 0) = 0.864999999999999;
	TX1(14, 0) = 0.864999999999999;
	TX1(0, 1) = 0;
	TX1(1, 1) = 75;
	TX1(2, 1) = 150;
	TX1(3, 1) = 225;
	TX1(4, 1) = 300;
	TX1(5, 1) = 0;
	TX1(6, 1) = 75;
	TX1(7, 1) = 150;
	TX1(8, 1) = 225;
	TX1(9, 1) = 300;
	TX1(10, 1) = 0;
	TX1(11, 1) = 75;
	TX1(12, 1) = 150;
	TX1(13, 1) = 225;
	TX1(14, 1) = 300;
	return TX1;
}

int main()
{
	MatrixXd TX1 = GetTX7();
	MatrixXd CN = GetTX7();
	//MatrixXd TX1 = GetTX2();
	//MatrixXd CN = GetTX2();

	MatrixXd C(1, 2);
	MatrixXd A(1, 2);
	C << 1.73, 600;
	A << 2, 64; //TX7
	//A << 2, 4; //TX2
	MatrixXd D(TX1.rows(), TX1.rows());
	Leicester::ThrustLib::Gaussian cGaussian(TX1, TX1);
	for (int i = 0; i < 1; i++)
	{
		printf("i=%i\r\n", i);
		vector<MatrixXd> res = cGaussian.Gaussian2d(A, C);
		//vector<MatrixXd> res = ThrustLib::Gaussian::Gaussian2d(TX1, CN, A, C);
		//wcout << "Phi1:" << endl;
		//wcout << printMatrix(res[0].col(0)) << endl;
		//wcout << "Phi2:" << endl;
		//wcout << printMatrix(res[1].col(0)) << endl;
		wcout << "D:" << endl;
		wcout << Utility::printMatrix(res[0].col(0)) << endl;
		wcout << "Dt:" << endl;
		wcout << Utility::printMatrix(res[1].col(0)) << endl;
		wcout << "Dx:" << endl;
		wcout << Utility::printMatrix(res[2].col(0)) << endl;
		wcout << "Dxx:" << endl;
		wcout << Utility::printMatrix(res[3].col(0)) << endl;
	}

	return 0;
}